# üîê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Google Sheets API –¥–ª—è –±–æ—Ç–∞

## üìã **–û–±–∑–æ—Ä**
–≠—Ç–æ—Ç –º–æ–¥—É–ª—å –ø–æ–∑–≤–æ–ª—è–µ—Ç –±–æ—Ç—É –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å Google Sheets —á–µ—Ä–µ–∑ —Å–µ—Ä–≤–∏—Å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç Google Cloud.

## üöÄ **–ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**

### **1. –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ Google Cloud**

#### **–®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞**
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ [Google Cloud Console](https://console.cloud.google.com/)
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π
3. –ó–∞–ø–æ–º–Ω–∏—Ç–µ **Project ID**

#### **–®–∞–≥ 2: –í–∫–ª—é—á–µ–Ω–∏–µ API**
1. –í –º–µ–Ω—é —Å–ª–µ–≤–∞ –≤—ã–±–µ—Ä–∏—Ç–µ "APIs & Services" ‚Üí "Library"
2. –ù–∞–π–¥–∏—Ç–µ "Google Sheets API"
3. –ù–∞–∂–º–∏—Ç–µ "Enable"

#### **–®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞**
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "APIs & Services" ‚Üí "Credentials"
2. –ù–∞–∂–º–∏—Ç–µ "Create Credentials" ‚Üí "Service Account"
3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ:
   - **Name**: `cardbot-sheets-api`
   - **Description**: `Service account for CardBot Google Sheets integration`
4. –ù–∞–∂–º–∏—Ç–µ "Create and Continue"
5. –ü—Ä–æ–ø—É—Å—Ç–∏—Ç–µ —Ä–æ–ª–∏ (–Ω–∞–∂–º–∏—Ç–µ "Continue")
6. –ù–∞–∂–º–∏—Ç–µ "Done"

#### **–®–∞–≥ 4: –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª—é—á–∞**
1. –í —Å–ø–∏—Å–∫–µ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ —Å–æ–∑–¥–∞–Ω–Ω—ã–π
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "Keys"
3. –ù–∞–∂–º–∏—Ç–µ "Add Key" ‚Üí "Create new key"
4. –í—ã–±–µ—Ä–∏—Ç–µ "JSON"
5. –°–∫–∞—á–∞–π—Ç–µ —Ñ–∞–π–ª `service-account.json`

### **2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ç–∞–±–ª–∏—Ü–µ**

#### **–®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ Google —Ç–∞–±–ª–∏—Ü—ã**
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ [Google Sheets](https://sheets.google.com/)
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é —Ç–∞–±–ª–∏—Ü—É –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ **ID —Ç–∞–±–ª–∏—Ü—ã** –∏–∑ URL:
   ```
   https://docs.google.com/spreadsheets/d/1RoWWv9BgiwlSu9H-KJNsFItQxlUVhG1WMbyB0eFxzYM/edit
   ID: 1RoWWv9BgiwlSu9H-KJNsFItQxlUVhG1WMbyB0eFxzYM
   ```

#### **–®–∞–≥ 2: –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞**
1. –í —Ç–∞–±–ª–∏—Ü–µ –Ω–∞–∂–º–∏—Ç–µ "Share" (–ü–æ–¥–µ–ª–∏—Ç—å—Å—è)
2. –î–æ–±–∞–≤—å—Ç–µ email —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ –∏–∑ `service-account.json`:
   ```
   cardbot-sheets-api@your-project.iam.gserviceaccount.com
   ```
3. –î–∞–π—Ç–µ –ø—Ä–∞–≤–∞ "Editor" (–†–µ–¥–∞–∫—Ç–æ—Ä)
4. –ù–∞–∂–º–∏—Ç–µ "Send"

### **3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Amvera**

#### **–í–∞—Ä–∏–∞–Ω—Ç A: Base64 –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)**

1. **–ó–∞–∫–æ–¥–∏—Ä—É–π—Ç–µ JSON –≤ base64:**
   ```bash
   # –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ (Linux/Mac)
   cat service-account.json | base64
   
   # –í Windows PowerShell
   [Convert]::ToBase64String([System.Text.Encoding]::UTF8.GetBytes((Get-Content service-account.json -Raw)))
   ```

2. **–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –≤ Amvera:**
   - **–ù–∞–∑–≤–∞–Ω–∏–µ:** `GOOGLE_SERVICE_ACCOUNT_BASE64`
   - **–ó–Ω–∞—á–µ–Ω–∏–µ:** `eyJ0eXBlIjoic2VydmljZV9hY2NvdW50Ii...` (–≤–µ—Å—å base64 –∫–æ–¥)

#### **–í–∞—Ä–∏–∞–Ω—Ç B: –û–±—ã—á–Ω—ã–π JSON (–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**
- **–ù–∞–∑–≤–∞–Ω–∏–µ:** `GOOGLE_SERVICE_ACCOUNT`
- **–ó–Ω–∞—á–µ–Ω–∏–µ:** `{"type":"service_account","project_id":"..."}`

#### **–í–∞—Ä–∏–∞–Ω—Ç C: –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É (–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**
- **–ù–∞–∑–≤–∞–Ω–∏–µ:** `GOOGLE_SERVICE_ACCOUNT_PATH`
- **–ó–Ω–∞—á–µ–Ω–∏–µ:** `/app/service-account.json`

## üß™ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**

### **–ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:**

1. **–¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:**
   ```
   /sheets_test
   ```

2. **–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–∞–±–ª–∏—Ü–µ:**
   ```
   /sheets_info 1RoWWv9BgiwlSu9H-KJNsFItQxlUVhG1WMbyB0eFxzYM
   ```

3. **–ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:**
   ```
   /sheets_read 1RoWWv9BgiwlSu9H-KJNsFItQxlUVhG1WMbyB0eFxzYM marketplaces
   ```

## üîí **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**

### **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **base64 –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ** –¥–ª—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- ‚úÖ –û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –ø—Ä–∞–≤–∞ —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º–∏ —Ç–∞–±–ª–∏—Ü–∞–º–∏
- ‚úÖ –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –∫–ª—é—á–∏ —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞
- ‚ùå –ù–ï –¥–æ–±–∞–≤–ª—è–π—Ç–µ `service-account.json` –≤ git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
- ‚ùå –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å –æ—Ç–∫—Ä—ã—Ç—ã–º JSON –≤ production

### **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞:**
- Google Sheets API: —á—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å
- Google Drive API: –¥–æ—Å—Ç—É–ø –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º —Ñ–∞–π–ª–∞–º
- –ù–ï –¥–∞–≤–∞–π—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ –≤–µ—Å—å Google Drive

## üö® **–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫**

### **–û—à–∏–±–∫–∞: "–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã"**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `GOOGLE_SERVICE_ACCOUNT_BASE64` —Å–æ–∑–¥–∞–Ω–∞ –≤ Amvera
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ base64 –∫–æ–¥ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π

### **–û—à–∏–±–∫–∞: "Access denied"**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å–µ—Ä–≤–∏—Å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Ç–∞–±–ª–∏—Ü—É
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∫–∞–∫ "Editor"

### **–û—à–∏–±–∫–∞: "Invalid JSON"**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ base64 –∫–æ–¥ –¥–µ–∫–æ–¥–∏—Ä—É–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å—Ö–æ–¥–Ω—ã–π JSON —Ñ–∞–π–ª –≤–∞–ª–∏–¥–Ω—ã–π

## üìö **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã**

- [Google Cloud Console](https://console.cloud.google.com/)
- [Google Sheets API Documentation](https://developers.google.com/sheets/api)
- [Service Account Best Practices](https://cloud.google.com/iam/docs/service-accounts-best-practices)
